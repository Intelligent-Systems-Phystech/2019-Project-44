\documentclass{beamer}

\usepackage[utf8]{inputenc}
\usepackage{adjustbox}
\usepackage[T2A]{fontenc}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{mathrsfs}
\usepackage{euscript}
\usepackage{upgreek}
\usepackage[english,russian]{babel}
\usepackage{array}
\usepackage{theorem}
\usepackage[all]{xy}
\usepackage{subfig}
\usepackage{epstopdf}   
\usepackage{tikz}       
\usepackage{pgfplots}   
\usepackage{color}
\usepackage{ifthen}
\usepackage{url}
\usepackage{makeidx}
\usepackage{pb-diagram}
\usepackage{balance}
\usepackage{multirow} 
\usepackage{bibentry}
\usepackage{booktabs}
\usepackage{cmap}
\usepackage{amsthm}
\usepackage[linesnumbered,ruled,vlined]{algorithm2e}
\usepackage[absolute]{textpos}
\usepackage{fleqn,psfrag,wrapfig,tikz}
\usepackage{algpseudocode}
\usepackage{amsmath}

\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}

\usepackage{graphics}
\usepackage{graphicx} % Allows including images
\usepackage{tabularx}
%\usepackage{jmlda}
\usetheme{Warsaw}
\usecolortheme{sidebartab}
%\definecolor{beamer@blendedblue}{RGB}{15,80,120}
%----------------------------------------------------------------------------------------------------------
\title[\hbox to 56mm{Достаточный объем выборки  \hfill\insertframenumber\,/\,\inserttotalframenumber}]
{Раннее прогнозирование достаточного объема выборки для обобщенной линейной модели}
\author[В.\,С.~Бучнев]{Валентин Бучнев}
\institute{Московский физико-технический институт}
\date{\footnotesize{
группа 694, 2020
\date{qq}
}}



\begin{document}

\begin{frame}
\titlepage % Print the title page as the first slide
\end{frame}

\begin{frame}
\frametitle{Прогнозирование объема выборки}begin{frame}
\frametitle{Результаты}


\textbf{Предсказание достаточного объема выборки, ALC метод.}
\begin{table}[h]
\label{table2}
\begin{tabularx}{0.7\textwidth}{|p{1in}|X|c|}
\hline
	\centering Выборка & \centering Реальное значение &Предсказание\\
	\hline
	 Servo & \centering не хватает данных & 450\\
	\hline
	Boston & \centering не хватает данных &1370\\
	\hline
	Diabetes & \centering 235 & 240\\
\hline
\end{tabularx}
\end{table}

\end{frame}
\begin{block}{Цель исследования}
Предложить метод предсказания достаточного объема выборки для обобщенной линейной модели на ранних этапах сбора данных.
\end{block}
\begin{block}{Проблема}
Большинство методов требуют заведомо избыточного объема выборки.
\end{block}
\begin{block}{Метод решения}
Оценка объема строится по собранной выборке путем анализа свойств функции ошибки обобщенной линейной модели.
\end{block}

\end{frame}

\begin{frame}
\frametitle{Существующие методы}

\textbf{Ассимптотические методы}

\begin{itemize}
  \item S.\,G.\;Self and R.\,H.,\; Mauritsen Power/sample size calculations for generalized linear
models~//~Biometrics, 1988
  \item G.\,Shieh,\;On power and sample size calculations for likelihood ratio tests in generalized linear models~//~Biometrics, 2000.
  \item G.\,Shieh\;On power and sample size calculations for Wald tests in generalized linear models~//~Journal of Statistical Planning and Inference, 2005.
\end{itemize}

\textbf{Байесовские методы}

\begin{itemize}
  \item D.\,B.\;Rubin and H.\,S.\;Stern\;Sample size determination using posterior predictive distributions~//~Sankhya : The Indian Journal of Statistics Special Issue on Bayesian Analysis, 1998.
\end{itemize}

\end{frame}

\begin{frame}
\frametitle{Постановка задачи раннего прогнозирования}
\begin{block}{Дано}
Выборка размера m: $~\mathfrak D_m = \{\textbf{x}_i, y_i\}_{i=1}^m,$

где $\textbf{x}_i \in \mathbb{R}^{n}$ - вектор признаков, $~y_i \in \mathbb{Y}$.
\end{block}
\begin{block}{Функция правдоподобия}
Определим функцию правдоподобия и логарифмическую функцию правдоподобия выборки $\mathfrak D$:
$$
L(\mathfrak D_m, \textbf{w}) = \prod_{y, \textbf{x} \in \mathfrak D_m} f(y, \textbf{x}, \textbf{w}),~~~ l(\mathfrak D_m, \textbf w) = \sum_{y, \textbf{x} \in \mathfrak D_m}\log f(y, \textbf{x}, \textbf{w}),
$$
где $f(y, \textbf{x}, \textbf{w})$ - аппроксимация плотности апостериорной вероятности выборки $\mathfrak D_m$ при заданном векторе параметров $\textbf{w}$.
\end{block}
\end{frame}

\begin{frame}
\frametitle{Постановка задачи раннего прогнозирования}
\begin{block}{Логарифмическая функция правдоподобия}
Будем рассматривать ожидаемое значение функции $l$:

$$
\tilde{l}(\mathfrak D)  = \underset{y, \textbf{x} \in \mathfrak D}{\mathsf E} l(\{y, \textbf{x}\}, \textbf w).
$$
\end{block}
\begin{block}{Ожидаемое значение}
Рассмотрим ожидаемое значение логарифма правдоподобия по разным обучающим выборкам $\mathfrak D_{\mathcal L_m}$ размера $m$:

$$
l(m) = \underset{\mathfrak D_{\mathcal L_m}}{\mathsf E} \tilde{l}(\mathfrak D_{\mathcal L_m}).
$$
\end{block}
\end{frame}


\begin{frame}
\frametitle{Постановка задачи раннего прогнозирования}
\begin{block}{Критерий достаточности объема}
Будем считать, что объем выборки $m^*$ достаточнен, если:

$$
\forall m^{\prime} > m^* ~~~ l(m^{\prime}) > (1 - \delta)\max\limits_{m > m^*}l(m),
$$
где $\delta$ --- достаточно малое пороговое значение.
\end{block}
\end{frame}

\begin{frame}
\frametitle{Предлагаемый метод решения}

\begin{block}{Семейство функций $\Phi$}
Для предсказания значения функции $\hat{l}(m)$ при $m > m_0$ введем параметрическое семейство функций 
\begin{equation}\label{Phi}
\Phi = \{\phi(m) =  a + b\cdot e^{c \cdot m} ~|~ a, b \in \mathbb{R}, c \in (-\infty, 0)\}
\end{equation}
\end{block}

\begin{block}{Аппроксимация $\phi(m) \sim l(m)$}
Аппроксимация функции  $\hat{l}(m)$ является решением следующей задачи:

\begin{equation}\label{argmin_MAPE}
\hat{\phi} =  \argmin_{\phi \in \Phi}\text{MAE}(\hat{l}, \phi, 1, m_0),
\end{equation}
\end{block}

\begin{block}{$\text{MAE}(\psi, \phi, m_1, m_2)$}
\begin{equation}\label{MAE}
\text{MAE}(\psi, \phi, m_1, m_2) = \frac{1}{m_2 - m_1 + 1}\sum_{i=m_1}^{m_2}|\phi(i) - \psi(i)|.
\end{equation}
\end{block}

\end{frame}

\begin{frame}
\frametitle{Критерий достаточности объёма}

\begin{block}{Оценка $\hat{m^*}$}
\begin{equation}\label{hat_m_star}
\hat{m^*} = \min\limits_{m}\max\limits_{m^{\prime} > m}\hat{\phi}(m^{\prime}) > (1 - \delta)\hat{\phi}(m),
\end{equation}
где $\delta$ --- достаточно малое пороговое значение.
\end{block}

\end{frame}

\begin{frame}
\frametitle{Вычислительный эксперимент}
\begin{block}{Цель эксперимента}
Проверить работоспособность предложенного метода.
\end{block}

$\newline$

\textbf{Выборки}

\end{frame}

\begin{frame}
\frametitle{Результаты}

\begin{table}[h!]
\begin{center}
\label{table1}
\begin{tabularx}{\textwidth}{|>{\centering\arraybackslash}X|>{\centering\arraybackslash}X|>{\centering\arraybackslash}X|>{\centering\arraybackslash}X|}
\hline
	\centering Выборка& Тип задачи & $m^*$ & $n^*$\\
	\hline
	Синтетическая, случайная выборка & регрессия & 72 & 10\\
	\hline
	Синтетическая, скоррелированная выборка & регрессия & 31 & 2\\
	\hline
	Синтетическая, ортогональная выборка & регрессия & 45 & 10\\
	\hline
	Синтетическая, избыточная выборка & регрессия & 22 & 5\\
	\hline
\end{tabularx}
\end{center}
\end{table}

\end{frame}

\begin{frame}
\frametitle{Результаты}

\begin{table}[h!]
\begin{center}
\label{table1}
\begin{tabularx}{\textwidth}{|>{\centering\arraybackslash}X|>{\centering\arraybackslash}X|>{\centering\arraybackslash}X|>{\centering\arraybackslash}X|}
\hline
	\centering Выборка& Тип задачи & $m^*$ & $n^*$\\
	\hline
	UCI repo, Diabetes & регрессия & 442 & 11\\
	\hline
	UCI repo, Boston & регрессия & 506 & 14\\
	\hline
	UCI repo, Wine & классификация & 130 & 14\\
	\hline
	UCI repo, Nba & классификация & 400 & 20\\
	\hline
\end{tabularx}
\end{center}
\end{table}

\end{frame}

\begin{frame}
\frametitle{Заключение}

\begin{itemize}
  \item Задача прогнозирования достаточного объема выборки сведена к задаче аппроксимации функции ошибок.
  \item Показана работоспособность предложенного метода на синтетических выборках, а также на выборках из UCI репозитория.
\end{itemize}

\end{frame}


\end{document}